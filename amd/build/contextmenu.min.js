/**
 * Grid Format
 *
 * @package    course/format
 * @subpackage grid
 * @version    See the value of '$plugin->version' in version.php.
 * @copyright  2017 Gareth J Barnard
 * @author     G J Barnard - {@link http://about.me/gjbarnard} and
 *                           {@link http://moodle.org/user/profile.php?id=442195}
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
/* jshint ignore:start */
define(["jquery","core/log"],function(a,b){b.debug("Grid Format Context Menu AMD");var c=!1,d=0,e=null,f=null;return a.fn.rightClickContextMenu=function(){a(this).find("li").each(function(){var f=a(this);f.contextmenu(function(a){a.preventDefault(),b.debug(f.html()),b.debug(f.find(".gridicon_link").html()),
//var icon_index = parseInt(us.find('.gridicon_link').get('id').replace("gridsection-", ""));
//var icon_index = parseInt(us.get('id').replace("gridsection-", ""));
b.debug(f.attr("class")),b.debug(f.find(".gridicon_link").attr("id")),d=parseInt(f.find(".gridicon_link").attr("id").replace("gridsection-","")),b.debug("Grid Format Context Menu AMD rightClickContextMenu id "+d),b.debug("Grid Format Context Menu AMD rightClickContextMenu pageX "+a.pageX+" pageY "+a.pageY),b.debug("Grid Format Context Menu AMD rightClickContextMenu clientX "+a.clientX+" clientY "+a.clientY),e.css("top",a.clientY).css("left",a.clientX),// Using window co-ordinates.
e.show(),c=!0})})},a.fn.notInMenu=function(c,d){var e=a(this).offset(),f=e.left+a(this).outerWidth(),g=e.top+a(this).outerHeight();return b.debug("contextMenu pageX "+c+" pageY "+d),b.debug("contextMenu left "+e.left+" top "+e.top+" width "+a(this).outerWidth()+" height "+a(this).outerHeight()+" usRight "+f+" usBottom "+g),!(c>=e.left&&c<=f&&d>=e.top&&d<=g)},{init:function(g){a(document).ready(function(a){f=g.sectionredirect,e=a("#gridcontextmenu"),a("#gridnewpage").click(function(){window.open(f+"&section="+d)}),a("#gridiconcontainer .gridicons").rightClickContextMenu(),a("body").mousedown(function(a){c&&e.notInMenu(a.pageX,a.pageY)&&(// Using page co-ordinates to compare with document offset.
e.hide(),c=!1)}),a(window).scroll(function(){c&&(e.hide(),c=!1)})}),b.debug("Grid Format Context Menu AMD init")}}});